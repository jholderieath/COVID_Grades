"0",""
"0","percent_grade <- dat %>%"
"0","    count(Term, Grade) %>%"
"0","    group_by(Term) %>%"
"0","    mutate(Percent = n / sum(n) * 100) %>%"
"0","    ungroup()"
"0",""
"0","percent_pfw <- dat %>%"
"0","    count(Term, pfw) %>%"
"0","    group_by(Term) %>%"
"0","    mutate(Percent = n / sum(n) * 100) %>%"
"0","    ungroup() %>%"
"0","    filter(pfw == ""PASS"" | pfw == ""FAIL"" | pfw == ""W"") "
"0",""
"0","p <- percent_grade %>%"
"0","    ggplot(aes(x = Grade, y = Percent, fill = Term)) +"
"0","    geom_bar(stat = ""identity"", position = ""dodge"")+"
"0","    theme(legend.position=""top"")  "
"0",""
"0","#  cowplot::theme_cowplot(font_size = 12) + "
"0",""
"0",""
"0","inset <- ggplot(percent_pfw, aes(x = pfw, y= Percent, fill = Term)) + "
"0","  geom_bar(stat = ""identity"", position = ""dodge"") + "
"0","    cowplot::theme_cowplot(font_size = 12) +"
"0","    theme(legend.position = ""none"") + "
"0","    xlab('') +"
"0","    ylab('') "
"0","     "
"0",""
"0","ggdraw(p +  theme_half_open(12)) +"
"0","  draw_plot(inset, .35, .45, .5, .5) +"
"0","  draw_plot_label("
"0","    c(""A"", ""B""),"
"0","    c(0, 0.35),"
"0","    c(1, 0.95),"
"0","    size = 12"
"0","  ) "

hist_A_v <- ggplot(d3_dum, aes(x=Term, y=PCT_A)) +
geom_violin()+
geom_boxplot(width=0.1)+
xlab('Term') +
ylab('Historic Percent Earning A') +
scale_x_discrete(labels=c("20183" = "SP18", "20193" = "SP19",
"20203" = "SP20"))+
scale_y_continuous(expand = c(0.1, .1))+
cowplot::theme_minimal_hgrid(11)
plotly::ggplotly(hist_A_v)
hist_A_indiv <-  d3_dum %>%
filter(ID %notin% c('ANSC223','ANSC230','ANSC301','ANSC315','PLSC312','WILD314')) %>%
ggplot(aes(x = Term, y = PCT_A, group =   interaction(UPPER,ID)))+
geom_smooth(method = 'lm',se=FALSE, size=1)+
stat_regline_equation(label.y=25, size = 2.5)+
facet_wrap('ID',nrow = 4)+
xlab('Term') +
ylab('Historic Percent Earning A') +
ggtitle('') +
theme(legend.position="none")+
scale_y_continuous(breaks=c(33,66,100), limits=c(0, NA))+
geom_point() +
scale_x_discrete(labels=c("20183" = "SP18", "20193" = "SP19",
"20203" = "SP20"))+
cowplot::theme_minimal_hgrid(11)
hist_PASS_v <- ggplot(d3_dum, aes(x=Term, y=PCT_PASS)) +
geom_violin()+
geom_boxplot(width=0.1)+
xlab('Term') +
ylab('Historic Percent Passing') +
scale_x_discrete(labels=c("20183" = "SP18", "20193" = "SP19",
"20203" = "SP20"))+
scale_y_continuous(expand = c(0.1, .1))+
cowplot::theme_minimal_hgrid(11)
plotly::ggplotly(hist_PASS_v)
hist_PASS <-  d3_dum %>%
filter(ID %notin% c('ANSC223','ANSC230','ANSC301','ANSC315','PLSC312','WILD314')) %>%
ggplot(aes(x = Term, y = PCT_PASS,   group =   interaction(UPPER,ID)))+
geom_point() +
geom_smooth(method = 'lm',se=FALSE, size=1)+
stat_regline_equation(label.y=25, size = 2.5)+
facet_wrap('ID',nrow = 4)+
xlab('Term') +
ylab('Historic Percent Passing') +
scale_y_continuous(breaks=c(33,66,100), limits=c(0, NA))+
ggtitle('')+
theme(legend.position="none")+
scale_x_discrete(labels=c("20183" = "SP18", "20193" = "SP19",
"20203" = "SP20"))+
cowplot::theme_minimal_hgrid(11)
hist_FINISH_v <- ggplot(d3_dum, aes(x=Term, y=PCT_FINISH)) +
geom_violin()+
geom_boxplot(width=0.1)+
xlab('Term') +
ylab('Historic Percent Finishing') +
scale_y_continuous(expand = c(0.1, .1))+
scale_x_discrete(labels=c("20183" = "SP18", "20193" = "SP19",
"20203" = "SP20"))+
cowplot::theme_minimal_hgrid(11)
hist_FINISH <-  d3_dum %>%
filter(ID %notin% c('ANSC223','ANSC230','ANSC301','ANSC315','PLSC312','WILD314')) %>%
ggplot(aes(x = Term, y = PCT_FINISH,   group =   interaction(UPPER,ID)))+
geom_point() +
geom_smooth(method = 'lm',se=FALSE, size=1)+
stat_regline_equation(label.y=25, size = 2.5)+
facet_wrap('ID',nrow = 4)+
xlab('Term') +
ylab('Historic Percent Finishing') +
ggtitle('')+
theme(legend.position="none")+
scale_x_discrete(labels=c("20183" = "SP18", "20193" = "SP19",
"20203" = "SP20"))+
scale_y_continuous(breaks=c(33,66,100), limits=c(0, NA))+
cowplot::theme_minimal_hgrid(11)
predict <- cowplot::plot_grid(predict_Finish,predict_Pass,predict_A,
labels = c("A. Predicted Percent Finishing",
"D. Predicted Percent Passing",
"G. Predicted Percent Earning an A"), label_size = 12,
hjust = 0, ncol = 1)
violin <- cowplot::plot_grid(hist_FINISH_v,hist_PASS_v,hist_A_v,
labels = c("B. Historic Distribution of Percent Finishing",
"E. Historic Distribution of Percent Passing",
"H. Historic Distribution of Percent Earning an A"), label_size = 12,
hjust = 0,  ncol = 1)
hist <- cowplot::plot_grid(hist_FINISH,hist_PASS,hist_A_indiv,
labels = c("C. Slope of Historic Percent Finishing",
"F. Slope of Historic Percent Passing",
"I. Slope of Historic Percent Earning an A"), label_size = 12,
hjust = -0.2, ncol = 1)
histAndResult <- plot_grid(predict,violin,hist,nrow = 1, rel_widths = c(.3,.3,1))
save_plot('histAndResult.png',plot= histAndResult, base_height = 13, base_width = 18)
histAndResult
hist
predict
save_plot('predict.png',plot= predict, base_height = 13, base_width = 3.375)
predict <- cowplot::plot_grid(predict_Finish,predict_Pass,predict_A,
labels = c("A. Predicted Percent Finishing",
"B. Predicted Percent Passing",
"C. Predicted Percent Earning an A"), label_size = 12,
hjust = 0, ncol = 1)
save_plot('predict.png',plot= predict, base_height = 13, base_width = 3.375)
save_plot('hist.png',plot= hist, base_height = 13, base_width = 6.5)
save_plot('hist.png',plot= hist, base_height = 13, base_width = 11.25)
save_plot('hist.png',plot= hist, base_height = 13, base_width = 11.25)
save_plot('hist.png',plot= hist, base_height = 13, base_width = 9.25)
save_plot('hist.png',plot= hist, base_height = 13, base_width = 8.25)
save_plot('hist.png',plot= hist, base_height = 13, base_width = 8.75)
hist <- cowplot::plot_grid(hist_FINISH,hist_PASS,hist_A_indiv,
labels = c("A. Slope of Historic Percent Finishing",
"B. Slope of Historic Percent Passing",
"C. Slope of Historic Percent Earning an A"), label_size = 12,
hjust = -0.2, ncol = 1)
save_plot('hist.png',plot= hist, base_height = 13, base_width = 8.75)
save_plot('predict.png',plot= predict, base_height = 9, base_width = 3.375)
save_plot('violin.png',plot= violin, base_height = 9, base_width = 3.375)
violin <- cowplot::plot_grid(hist_FINISH_v,hist_PASS_v,hist_A_v,
labels = c("A. Historic Distribution of Percent Finishing",
"B. Historic Distribution of Percent Passing",
"C. Historic Distribution of Percent Earning an A"), label_size = 12,
hjust = 0,  ncol = 1)
save_plot('violin.png',plot= violin, base_height = 9, base_width = 3.375)
save_plot('predict.png',plot= predict, base_height = 8, base_width = 3.375)
violin <- cowplot::plot_grid(hist_FINISH_v,hist_PASS_v,hist_A_v,
labels = c("A. Historic Distribution of Percent Finishing",
"B. Historic Distribution of Percent Passing",
"C. Historic Distribution of Percent Earning an A"), label_size = 12,
hjust = 0,  ncol = 1)
save_plot('violin.png',plot= violin, base_height = 8, base_width = 3.375)
save_plot('predict.png',plot= predict, base_height = 7, base_width = 3.375)
predict <- cowplot::plot_grid(predict_Finish,predict_Pass,predict_A,
labels = c("A. Predicted Percent \\Finishing",
"B. Predicted Percent \\Passing",
"C. Predicted Percent \\Earning an A"), label_size = 12,
hjust = 0, ncol = 1)
save_plot('predict.png',plot= predict, base_height = 7, base_width = 3.375)
predict <- cowplot::plot_grid(predict_Finish,predict_Pass,predict_A,
labels = c("A. Predicted Percent \\Finishing",
"B. Predicted Percent \\Passing",
"C. Predicted Percent \\Earning an A"), label_size = 12,
hjust = 0, ncol = 1)
save_plot('predict.png',plot= predict, base_height = 7, base_width = 3.375)
predict <- cowplot::plot_grid(predict_Finish,predict_Pass,predict_A,
labels = c("A. Predicted Percent \nFinishing",
"B. Predicted Percent \nPassing",
"C. Predicted Percent \nEarning an A"), label_size = 12,
hjust = 0, ncol = 1)
save_plot('predict.png',plot= predict, base_height = 7, base_width = 3.375)
predict_Finish <- plot(ggFinish, add.data = TRUE) +
xlab('Spring 2020 Binary') +
ylab('Predicted Percent \nFinishing') +
ggtitle('')+
cowplot::theme_minimal_hgrid(11)
ggPass <- ggpredict(pass_poisson, terms = "Term_20203")
predict_Pass <- plot(ggPass, add.data = TRUE) +
xlab('Spring 2020 Binary') +
ylab('Predicted Percent \nPassing') +
ggtitle('')+
cowplot::theme_minimal_hgrid(11)
ggA <- ggpredict(a_poisson, terms = "Term_20203")
hist_A_v <- ggplot(d3_dum, aes(x=Term, y=PCT_A)) +
geom_violin()+
geom_boxplot(width=0.1)+
xlab('Term') +
ylab('Historic Percent Earning A') +
scale_x_discrete(labels=c("20183" = "SP18", "20193" = "SP19",
"20203" = "SP20"))+
scale_y_continuous(expand = c(0.1, .1))+
cowplot::theme_minimal_hgrid(11)
plotly::ggplotly(hist_A_v)
hist_A_indiv <-  d3_dum %>%
filter(ID %notin% c('ANSC223','ANSC230','ANSC301','ANSC315','PLSC312','WILD314')) %>%
ggplot(aes(x = Term, y = PCT_A, group =   interaction(UPPER,ID)))+
geom_smooth(method = 'lm',se=FALSE, size=1)+
stat_regline_equation(label.y=25, size = 2.5)+
facet_wrap('ID',nrow = 4)+
xlab('Term') +
ylab('Historic Percent Earning A') +
ggtitle('') +
theme(legend.position="none")+
scale_y_continuous(breaks=c(33,66,100), limits=c(0, NA))+
geom_point() +
scale_x_discrete(labels=c("20183" = "SP18", "20193" = "SP19",
"20203" = "SP20"))+
cowplot::theme_minimal_hgrid(11)
plotly::ggplotly(hist_PASS_v)
hist_PASS <-  d3_dum %>%
filter(ID %notin% c('ANSC223','ANSC230','ANSC301','ANSC315','PLSC312','WILD314')) %>%
ggplot(aes(x = Term, y = PCT_PASS,   group =   interaction(UPPER,ID)))+
geom_point() +
geom_smooth(method = 'lm',se=FALSE, size=1)+
stat_regline_equation(label.y=25, size = 2.5)+
facet_wrap('ID',nrow = 4)+
xlab('Term') +
ylab('Historic Percent Passing') +
scale_y_continuous(breaks=c(33,66,100), limits=c(0, NA))+
ggtitle('')+
theme(legend.position="none")+
scale_x_discrete(labels=c("20183" = "SP18", "20193" = "SP19",
"20203" = "SP20"))+
cowplot::theme_minimal_hgrid(11)
hist_FINISH_v <- ggplot(d3_dum, aes(x=Term, y=PCT_FINISH)) +
geom_violin()+
geom_boxplot(width=0.1)+
xlab('Term') +
ylab('Historic Percent Finishing') +
scale_y_continuous(expand = c(0.1, .1))+
scale_x_discrete(labels=c("20183" = "SP18", "20193" = "SP19",
"20203" = "SP20"))+
cowplot::theme_minimal_hgrid(11)
hist_FINISH <-  d3_dum %>%
filter(ID %notin% c('ANSC223','ANSC230','ANSC301','ANSC315','PLSC312','WILD314')) %>%
ggplot(aes(x = Term, y = PCT_FINISH,   group =   interaction(UPPER,ID)))+
geom_point() +
geom_smooth(method = 'lm',se=FALSE, size=1)+
stat_regline_equation(label.y=25, size = 2.5)+
facet_wrap('ID',nrow = 4)+
xlab('Term') +
ylab('Historic Percent Finishing') +
ggtitle('')+
theme(legend.position="none")+
scale_x_discrete(labels=c("20183" = "SP18", "20193" = "SP19",
"20203" = "SP20"))+
scale_y_continuous(breaks=c(33,66,100), limits=c(0, NA))+
cowplot::theme_minimal_hgrid(11)
predict <- cowplot::plot_grid(predict_Finish,predict_Pass,predict_A,
labels = c("A. Predicted Percent Finishing",
"B. Predicted Percent Passing",
"C. Predicted Percent Earning an A"), label_size = 12,
hjust = 0, ncol = 1)
save_plot('predict.png',plot= predict, base_height = 7, base_width = 3.375)
hist_A_v <- ggplot(d3_dum, aes(x=Term, y=PCT_A)) +
geom_violin()+
geom_boxplot(width=0.1)+
xlab('Term') +
ylab('Historic Percent \nEarning A') +
scale_x_discrete(labels=c("20183" = "SP18", "20193" = "SP19",
"20203" = "SP20"))+
scale_y_continuous(expand = c(0.1, .1))+
cowplot::theme_minimal_hgrid(11)
plotly::ggplotly(hist_A_v)
predict <- cowplot::plot_grid(predict_Finish,predict_Pass,predict_A,
labels = c("A. Predicted Percent Finishing",
"B. Predicted Percent Passing",
"C. Predicted Percent Earning an A"), label_size = 12,
hjust = 0, ncol = 1)
save_plot('predict.png',plot= predict, base_height = 7, base_width = 3.375)
predict_A <- plot(ggA,add.data = TRUE) +
xlab('Spring 2020 Binary') +
ylab('Predicted Percent \nEarning A') +
ggtitle('')+
cowplot::theme_minimal_hgrid(11)
hist_A_v <- ggplot(d3_dum, aes(x=Term, y=PCT_A)) +
geom_violin()+
geom_boxplot(width=0.1)+
xlab('Term') +
ylab('Historic Percent \nEarning A') +
scale_x_discrete(labels=c("20183" = "SP18", "20193" = "SP19",
"20203" = "SP20"))+
scale_y_continuous(expand = c(0.1, .1))+
cowplot::theme_minimal_hgrid(11)
plotly::ggplotly(hist_A_v)
hist_A_indiv <-  d3_dum %>%
filter(ID %notin% c('ANSC223','ANSC230','ANSC301','ANSC315','PLSC312','WILD314')) %>%
ggplot(aes(x = Term, y = PCT_A, group =   interaction(UPPER,ID)))+
geom_smooth(method = 'lm',se=FALSE, size=1)+
stat_regline_equation(label.y=25, size = 2.5)+
facet_wrap('ID',nrow = 4)+
xlab('Term') +
ylab('Historic Percent Earning A') +
ggtitle('') +
theme(legend.position="none")+
scale_y_continuous(breaks=c(33,66,100), limits=c(0, NA))+
geom_point() +
scale_x_discrete(labels=c("20183" = "SP18", "20193" = "SP19",
"20203" = "SP20"))+
cowplot::theme_minimal_hgrid(11)
hist_PASS_v <- ggplot(d3_dum, aes(x=Term, y=PCT_PASS)) +
geom_violin()+
geom_boxplot(width=0.1)+
xlab('Term') +
ylab('Historic Percent Passing') +
scale_x_discrete(labels=c("20183" = "SP18", "20193" = "SP19",
"20203" = "SP20"))+
scale_y_continuous(expand = c(0.1, .1))+
cowplot::theme_minimal_hgrid(11)
plotly::ggplotly(hist_PASS_v)
hist_PASS <-  d3_dum %>%
filter(ID %notin% c('ANSC223','ANSC230','ANSC301','ANSC315','PLSC312','WILD314')) %>%
ggplot(aes(x = Term, y = PCT_PASS,   group =   interaction(UPPER,ID)))+
geom_point() +
geom_smooth(method = 'lm',se=FALSE, size=1)+
stat_regline_equation(label.y=25, size = 2.5)+
facet_wrap('ID',nrow = 4)+
xlab('Term') +
ylab('Historic Percent Passing') +
scale_y_continuous(breaks=c(33,66,100), limits=c(0, NA))+
ggtitle('')+
theme(legend.position="none")+
scale_x_discrete(labels=c("20183" = "SP18", "20193" = "SP19",
"20203" = "SP20"))+
cowplot::theme_minimal_hgrid(11)
hist_FINISH_v <- ggplot(d3_dum, aes(x=Term, y=PCT_FINISH)) +
geom_violin()+
geom_boxplot(width=0.1)+
xlab('Term') +
ylab('Historic Percent Finishing') +
scale_y_continuous(expand = c(0.1, .1))+
scale_x_discrete(labels=c("20183" = "SP18", "20193" = "SP19",
"20203" = "SP20"))+
cowplot::theme_minimal_hgrid(11)
hist_FINISH <-  d3_dum %>%
filter(ID %notin% c('ANSC223','ANSC230','ANSC301','ANSC315','PLSC312','WILD314')) %>%
ggplot(aes(x = Term, y = PCT_FINISH,   group =   interaction(UPPER,ID)))+
geom_point() +
geom_smooth(method = 'lm',se=FALSE, size=1)+
stat_regline_equation(label.y=25, size = 2.5)+
facet_wrap('ID',nrow = 4)+
xlab('Term') +
ylab('Historic Percent Finishing') +
ggtitle('')+
theme(legend.position="none")+
scale_x_discrete(labels=c("20183" = "SP18", "20193" = "SP19",
"20203" = "SP20"))+
scale_y_continuous(breaks=c(33,66,100), limits=c(0, NA))+
cowplot::theme_minimal_hgrid(11)
predict <- cowplot::plot_grid(predict_Finish,predict_Pass,predict_A,
labels = c("A. Predicted Percent Finishing",
"B. Predicted Percent Passing",
"C. Predicted Percent Earning an A"), label_size = 12,
hjust = 0, ncol = 1)
save_plot('predict.png',plot= predict, base_height = 7, base_width = 3.375)
hist_A_v <- ggplot(d3_dum, aes(x=Term, y=PCT_A)) +
geom_violin()+
geom_boxplot(width=0.1)+
xlab('Term') +
ylab('Historic Percent \nEarning A') +
scale_x_discrete(labels=c("20183" = "SP18", "20193" = "SP19",
"20203" = "SP20"))+
scale_y_continuous(expand = c(0.1, .1))+
cowplot::theme_minimal_hgrid(11)
plotly::ggplotly(hist_A_v)
hist_A_indiv <-  d3_dum %>%
filter(ID %notin% c('ANSC223','ANSC230','ANSC301','ANSC315','PLSC312','WILD314')) %>%
ggplot(aes(x = Term, y = PCT_A, group =   interaction(UPPER,ID)))+
geom_smooth(method = 'lm',se=FALSE, size=1)+
stat_regline_equation(label.y=25, size = 2.5)+
facet_wrap('ID',nrow = 4)+
xlab('Term') +
ylab('Historic Percent \nEarning A') +
ggtitle('') +
theme(legend.position="none")+
scale_y_continuous(breaks=c(33,66,100), limits=c(0, NA))+
geom_point() +
scale_x_discrete(labels=c("20183" = "SP18", "20193" = "SP19",
"20203" = "SP20"))+
cowplot::theme_minimal_hgrid(11)
hist_PASS_v <- ggplot(d3_dum, aes(x=Term, y=PCT_PASS)) +
geom_violin()+
geom_boxplot(width=0.1)+
xlab('Term') +
ylab('Historic Percent \nPassing') +
scale_x_discrete(labels=c("20183" = "SP18", "20193" = "SP19",
"20203" = "SP20"))+
scale_y_continuous(expand = c(0.1, .1))+
cowplot::theme_minimal_hgrid(11)
plotly::ggplotly(hist_PASS_v)
hist_PASS <-  d3_dum %>%
filter(ID %notin% c('ANSC223','ANSC230','ANSC301','ANSC315','PLSC312','WILD314')) %>%
ggplot(aes(x = Term, y = PCT_PASS,   group =   interaction(UPPER,ID)))+
geom_point() +
geom_smooth(method = 'lm',se=FALSE, size=1)+
stat_regline_equation(label.y=25, size = 2.5)+
facet_wrap('ID',nrow = 4)+
xlab('Term') +
ylab('Historic Percent \nPassing') +
scale_y_continuous(breaks=c(33,66,100), limits=c(0, NA))+
ggtitle('')+
theme(legend.position="none")+
scale_x_discrete(labels=c("20183" = "SP18", "20193" = "SP19",
"20203" = "SP20"))+
cowplot::theme_minimal_hgrid(11)
hist_FINISH_v <- ggplot(d3_dum, aes(x=Term, y=PCT_FINISH)) +
geom_violin()+
geom_boxplot(width=0.1)+
xlab('Term') +
ylab('Historic Percent \nFinishing') +
scale_y_continuous(expand = c(0.1, .1))+
scale_x_discrete(labels=c("20183" = "SP18", "20193" = "SP19",
"20203" = "SP20"))+
cowplot::theme_minimal_hgrid(11)
hist_FINISH <-  d3_dum %>%
filter(ID %notin% c('ANSC223','ANSC230','ANSC301','ANSC315','PLSC312','WILD314')) %>%
ggplot(aes(x = Term, y = PCT_FINISH,   group =   interaction(UPPER,ID)))+
geom_point() +
geom_smooth(method = 'lm',se=FALSE, size=1)+
stat_regline_equation(label.y=25, size = 2.5)+
facet_wrap('ID',nrow = 4)+
xlab('Term') +
ylab('Historic Percent \nFinishing') +
ggtitle('')+
theme(legend.position="none")+
scale_x_discrete(labels=c("20183" = "SP18", "20193" = "SP19",
"20203" = "SP20"))+
scale_y_continuous(breaks=c(33,66,100), limits=c(0, NA))+
cowplot::theme_minimal_hgrid(11)
predict <- cowplot::plot_grid(predict_Finish,predict_Pass,predict_A,
labels = c("A. Predicted Percent Finishing",
"B. Predicted Percent Passing",
"C. Predicted Percent Earning an A"), label_size = 12,
hjust = 0, ncol = 1)
save_plot('predict.png',plot= predict, base_height = 7, base_width = 3.375)
violin <- cowplot::plot_grid(hist_FINISH_v,hist_PASS_v,hist_A_v,
labels = c("A. Historic Distribution of Percent Finishing",
"B. Historic Distribution of Percent Passing",
"C. Historic Distribution of Percent Earning an A"), label_size = 12,
hjust = 0,  ncol = 1)
save_plot('violin.png',plot= violin, base_height = 8, base_width = 3.375)
save_plot('violin.png',plot= violin, base_height = 7, base_width = 3.375)
violin <- cowplot::plot_grid(hist_FINISH_v,hist_PASS_v,hist_A_v,
labels = c("A. Historic Distribution of Percent Finishing",
"B. Historic Distribution of Percent Passing",
"C. Historic Distribution of Percent Earning an A"), label_size = 10,
hjust = 0,  ncol = 1)
save_plot('violin.png',plot= violin, base_height = 7, base_width = 3.375)
predict_A <- plot(ggA,add.data = TRUE) +
xlab('Spring 2020 Binary') +
ylab('Predicted Percent \nEarning A') +
ggtitle('')+
cowplot::theme_minimal_hgrid(11)
hist_A_v <- ggplot(d3_dum, aes(x=Term, y=PCT_A)) +
geom_violin()+
geom_boxplot(width=0.1)+
xlab('Term') +
ylab('Historic Percent \nEarning A') +
scale_x_discrete(labels=c("20183" = "SP18", "20193" = "SP19",
"20203" = "SP20"))+
scale_y_continuous(expand = c(0.1, .1))+
cowplot::theme_minimal_hgrid(11)
hist_A_indiv <-  d3_dum %>%
filter(ID %notin% c('ANSC223','ANSC230','ANSC301','ANSC315','PLSC312','WILD314')) %>%
ggplot(aes(x = Term, y = PCT_A, group =   interaction(UPPER,ID)))+
geom_smooth(method = 'lm',se=FALSE, size=1)+
stat_regline_equation(label.y=25, size = 2.5)+
facet_wrap('ID',nrow = 4)+
xlab('Term') +
ylab('Historic Percent \nEarning A') +
ggtitle('') +
theme(legend.position="none")+
scale_y_continuous(breaks=c(33,66,100), limits=c(0, NA))+
geom_point() +
scale_x_discrete(labels=c("20183" = "SP18", "20193" = "SP19",
"20203" = "SP20"))+
cowplot::theme_minimal_hgrid(11)
hist_PASS_v <- ggplot(d3_dum, aes(x=Term, y=PCT_PASS)) +
geom_violin()+
geom_boxplot(width=0.1)+
xlab('Term') +
ylab('Historic Percent \nPassing') +
scale_x_discrete(labels=c("20183" = "SP18", "20193" = "SP19",
"20203" = "SP20"))+
scale_y_continuous(expand = c(0.1, .1))+
cowplot::theme_minimal_hgrid(11)
plotly::ggplotly(hist_PASS_v)
hist_PASS <-  d3_dum %>%
filter(ID %notin% c('ANSC223','ANSC230','ANSC301','ANSC315','PLSC312','WILD314')) %>%
ggplot(aes(x = Term, y = PCT_PASS,   group =   interaction(UPPER,ID)))+
geom_point() +
geom_smooth(method = 'lm',se=FALSE, size=1)+
stat_regline_equation(label.y=25, size = 2.5)+
facet_wrap('ID',nrow = 4)+
xlab('Term') +
ylab('Historic Percent \nPassing') +
scale_y_continuous(breaks=c(33,66,100), limits=c(0, NA))+
ggtitle('')+
theme(legend.position="none")+
scale_x_discrete(labels=c("20183" = "SP18", "20193" = "SP19",
"20203" = "SP20"))+
cowplot::theme_minimal_hgrid(11)
hist_FINISH_v <- ggplot(d3_dum, aes(x=Term, y=PCT_FINISH)) +
geom_violin()+
geom_boxplot(width=0.1)+
xlab('Term') +
ylab('Historic Percent \nFinishing') +
scale_y_continuous(expand = c(0.1, .1))+
scale_x_discrete(labels=c("20183" = "SP18", "20193" = "SP19",
"20203" = "SP20"))+
cowplot::theme_minimal_hgrid(11)
hist_FINISH <-  d3_dum %>%
filter(ID %notin% c('ANSC223','ANSC230','ANSC301','ANSC315','PLSC312','WILD314')) %>%
ggplot(aes(x = Term, y = PCT_FINISH,   group =   interaction(UPPER,ID)))+
geom_point() +
geom_smooth(method = 'lm',se=FALSE, size=1)+
stat_regline_equation(label.y=25, size = 2.5)+
facet_wrap('ID',nrow = 4)+
xlab('Term') +
ylab('Historic Percent \nFinishing') +
ggtitle('')+
theme(legend.position="none")+
scale_x_discrete(labels=c("20183" = "SP18", "20193" = "SP19",
"20203" = "SP20"))+
scale_y_continuous(breaks=c(33,66,100), limits=c(0, NA))+
cowplot::theme_minimal_hgrid(11)
save_plot('predict.png',plot= predict, base_height = 7, base_width = 3.375)
save_plot('hist.png',plot= hist, base_height = 7, base_width = 8.75)
hist <- cowplot::plot_grid(hist_FINISH,hist_PASS,hist_A_indiv,
labels = c("A. Slope of Historic Percent Finishing",
"B. Slope of Historic Percent Passing",
"C. Slope of Historic Percent Earning an A"), label_size = 10,
hjust = -0.2, ncol = 1)
save_plot('hist.png',plot= hist, base_height = 7, base_width = 8.75)
save_plot('hist.png',plot= hist, base_height = 9, base_width = 8.75)
save_plot('hist.png',plot= hist, base_height = 10, base_width = 8.75)
